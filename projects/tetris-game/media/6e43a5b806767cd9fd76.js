(()=>{"use strict";var e={849:(e,t,i)=>{i.r(t)},985:(e,t,i)=>{i.r(t)},496:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0;class i{static setConfig({width:e,height:t}){i.width=e,i.height=t,i.partSize=t/20}}t.Config=i},491:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Field=void 0,t.Field=class{constructor(){this.field=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]]}render(e){this.field.forEach(((t,i)=>{t.forEach(((t,r)=>{"number"!=typeof t&&t.render(r,i,e)}))}))}append(e){e.getTemplate().forEach(((t,i)=>{t.forEach(((t,r)=>{"number"!=typeof t&&(this.field[e.getY()+i][e.getX()+r]=t)}))}))}checkLinesFilled(e){const t=e.getTemplate();let i=!1;for(let r=0;r<t.length;r++){const t=this.field[r+e.getY()];for(let e=0;e<t.length;e++){if("number"==typeof t[e]){i=!1;break}i=!0}i&&this.removeLines(e.getY()+r),i=!1}}removeLines(e){for(this.field=this.field.filter(((t,i)=>i!==e));this.field.length<20;)this.field.unshift([0,0,0,0,0,0,0,0,0,0])}checkFieldPartCollision(e){const t=e.getTemplate();for(let i=0;i<t.length;i++){const r=t[i];for(let t=0;t<r.length;t++)if("number"!=typeof r[t]&&"number"!=typeof this.field[e.getY()+i][e.getX()+t])return!0}return!1}checkFieldBottomCollision(e){const t=e.getTemplate();return(e.getY()+t.length>=this.field.length+1||!!this.checkFieldPartCollision(e))&&(e.setY(e.getY()-1),!0)}getField(){return this.field}}},939:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Figure=void 0;const r=i(220),n=i(496);t.Figure=class{constructor(e,t){this.color=e,this.template=r.Utils.templateToFigure(e,t),this.x=n.Config.width/n.Config.partSize/2-Math.round(t[0].length/2),this.y=0,this.prevX=this.x,this.prevY=this.y}render(e){this.template.forEach(((t,i)=>{t.map(((t,r)=>{"number"!=typeof t&&t.render(r+this.x,i+this.y,e)}))}))}turn(){this.template=r.Utils.turnFigure(this.template)}turnBackward(){this.template=r.Utils.turnFigureBackward(this.template)}moveDown(){this.y++}moveLeft(){this.prevX=this.x,this.x--}moveRight(){this.prevX=this.x,this.x++}getX(){return this.x}getY(){return this.y}setX(e){this.prevX=this.x,this.x=e}setY(e){this.prevY=this.y,this.y=e}moveToPrevXY(){this.x=this.prevX,this.y=this.prevY}getTemplate(){return this.template}}},714:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FigurePart=void 0;const r=i(496);t.FigurePart=class{constructor(e){this.color=e}render(e,t,i){const n=e*r.Config.partSize,s=n+r.Config.partSize,o=t*r.Config.partSize,h=o+r.Config.partSize,l=1.75;i.fillStyle=this.color,i.fillRect(e*r.Config.partSize,t*r.Config.partSize,r.Config.partSize,r.Config.partSize),i.beginPath(),i.lineWidth=3.5,i.strokeStyle="#00000022",this.drawLine(s-l,o,s-l,h,i),this.drawLine(n,h-l,s,h-l,i),i.stroke(),i.beginPath(),i.lineWidth=3.5,i.strokeStyle="#ffffffbb",this.drawLine(n,o+l,s,o+l,i),this.drawLine(n+l,o,n+l,h,i),i.stroke()}drawLine(e,t,i,r,n){n.moveTo(e,t),n.lineTo(i,r)}}},56:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FigureType=void 0,t.FigureType=[[[1,1,1,1]],[[0,1],[0,1],[1,1]],[[1,0],[1,0],[1,1]],[[1,1],[1,1]],[[1,0],[1,1],[0,1]],[[1,0],[1,1],[1,0]],[[0,1],[1,1],[1,0]]]},611:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const r=i(601),n=i(220),s=i(939),o=i(496),h=i(491);t.Game=class{constructor(e){this.configureCanvas(e),this.field=new h.Field,this.figure=new s.Figure(n.Utils.getRandomColor(),n.Utils.getRandomFigure()),window.addEventListener("resize",(()=>{this.configureCanvas(e),this.render(this.context)})),window.addEventListener("keydown",this.keyPressed.bind(this))}configureCanvas(e){this.canvas=e,this.context=e.getContext("2d"),o.Config.setConfig({width:window.innerHeight/20*10,height:window.innerHeight}),this.canvas.width=o.Config.width,this.canvas.height=o.Config.height}render(e){e.fillStyle="#ffafaf",e.fillRect(0,0,o.Config.width,o.Config.height),this.field.render(e),this.figure.render(e),this.renderGrid(e)}renderGrid(e){e.strokeStyle="#000000",e.lineWidth=.5;for(let t=0;t<=o.Config.width/o.Config.partSize;t++)e.beginPath(),e.moveTo(t*o.Config.partSize,0),e.lineTo(t*o.Config.partSize,o.Config.height),e.stroke();for(let t=0;t<=o.Config.height/o.Config.partSize;t++)e.beginPath(),e.moveTo(0,t*o.Config.partSize),e.lineTo(o.Config.width,t*o.Config.partSize),e.stroke()}keyPressed(e){switch(e.key){case r.KeyType.LEFT:this.figure.moveLeft(),(this.figure.getX()<0||this.field.checkFieldPartCollision(this.figure))&&this.figure.setX(this.figure.getX()+1);break;case r.KeyType.RIGHT:this.figure.moveRight(),(this.figure.getX()+this.figure.getTemplate()[0].length-1>this.field.getField()[0].length-1||this.field.checkFieldPartCollision(this.figure))&&this.figure.setX(this.figure.getX()-1);break;case r.KeyType.UP:this.turnFigure();break;case r.KeyType.DOWN:this.moveDown()}this.render(this.context)}moveDown(){this.figure.moveDown(),this.field.checkFieldBottomCollision(this.figure)&&(this.field.append(this.figure),this.field.checkLinesFilled(this.figure),this.figure=new s.Figure(n.Utils.getRandomColor(),n.Utils.getRandomFigure())),this.render(this.context)}turnFigure(){this.figure.turn(),this.field.checkFieldPartCollision(this.figure)&&this.figure.turnBackward()}gamePlay(){this.moveDown()}start(){this.render(this.context),setInterval(this.gamePlay.bind(this),1e3)}}},601:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyType=void 0,(i=t.KeyType||(t.KeyType={})).RIGHT="ArrowRight",i.LEFT="ArrowLeft",i.UP="ArrowUp",i.DOWN="ArrowDown"},220:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const r=i(56),n=i(714);class s{static getRandomFigure(){return r.FigureType[s.getRandom(0,r.FigureType.length-1)]}static getRandom(e,t){return Math.round(e+Math.random()*t)}static getRandomColor(){const e=["#e53935","#8e24aa","#3949ab","#039be5","#43a047","#c0ca33","#ffb300","#f4511e","#546e7a","#9CCC65","#1565C0","#F06292","#B388FF","#82B1FF","#FF6D00"];return e[s.getRandom(0,e.length-1)]}static templateToFigure(e,t){return t.map((t=>t.map((t=>0!==t?new n.FigurePart(e):t))))}static turnFigure(e){const t=[...e];let i=new Array(t[0].length).fill(0).map((e=>new Array(t.length).fill(0)));return t.forEach(((e,t)=>{e.forEach(((e,r)=>{i[r][i[0].length-t-1]=e}))})),i}static turnFigureBackward(e){const t=[...e];let i=new Array(t[0].length).fill(0).map((e=>new Array(t.length).fill(0)));return t.forEach(((e,t)=>{e.forEach(((e,r)=>{i[i.length-r-1][t]=e}))})),i}}t.Utils=s}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,i),s.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=i(611);i(849),i(985);const t=document.getElementById("canvas");new e.Game(t).start()})()})();
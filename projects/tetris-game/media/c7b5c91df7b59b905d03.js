(()=>{"use strict";var e={849:(e,t,i)=>{i.r(t)},985:(e,t,i)=>{i.r(t)},496:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0;class i{static setConfig({width:e,height:t}){i.width=e,i.height=t,i.partSize=t/20}}t.Config=i},491:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Field=void 0;const r=i(220),n=i(831);t.Field=class{constructor(e){this.field=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],e&&(this.field=e.map((e=>e.map((e=>1===e?new n.FigurePart(r.Utils.getRandomColor()):e)))))}render(e){this.field.forEach(((t,i)=>{t.forEach(((t,r)=>{"number"!=typeof t&&t.render(r,i,e)}))}))}append(e){e.getTemplate().forEach(((t,i)=>{t.forEach(((t,r)=>{"number"!=typeof t&&(this.field[e.getY()+i][e.getX()+r]=t)}))}))}checkLinesFilled(e){const t=e.getTemplate();let i=!1;for(let r=0;r<t.length;r++){const t=this.field[r+e.getY()];for(let e=0;e<t.length;e++){if("number"==typeof t[e]){i=!1;break}i=!0}i&&this.removeLines(e.getY()+r),i=!1}}removeLines(e){for(this.field=this.field.filter(((t,i)=>i!==e));this.field.length<20;)this.field.unshift([0,0,0,0,0,0,0,0,0,0])}checkFieldPartCollision(e){const t=e.getTemplate();for(let i=0;i<t.length;i++){const r=t[i];for(let t=0;t<r.length;t++)if("number"!=typeof r[t]&&"number"!=typeof this.field[e.getY()+i][e.getX()+t])return!0}return!1}checkFieldBottomCollision(e){const t=e.getTemplate();return e.getY()+t.length>=this.field.length+1||!!this.checkFieldPartCollision(e)}getField(){return this.field}}},611:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=i(695),n=i(496);t.default=class{constructor(e){this.configureCanvas(e),this.screen=new r.MenuScreen(this),this.render(this.context),window.addEventListener("resize",(()=>{this.configureCanvas(e),this.render(this.context)})),window.addEventListener("keydown",this.keyPressed.bind(this))}configureCanvas(e){this.canvas=e,this.context=e.getContext("2d"),n.Config.setConfig({width:window.innerHeight/20*10,height:window.innerHeight}),this.canvas.width=n.Config.width,this.canvas.height=n.Config.height}render(e){this.screen.render(e)}setScreen(e){this.screen=e}keyPressed(e){this.screen.keyPressed(e),this.screen.render(this.context)}}},601:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyType=void 0,(i=t.KeyType||(t.KeyType={})).RIGHT="ArrowRight",i.LEFT="ArrowLeft",i.UP="ArrowUp",i.DOWN="ArrowDown",i.ENTER="Enter"},220:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;const r=i(831);class n{static getRandomFigure(){return r.FigureType[n.getRandom(0,r.FigureType.length-1)]}static getRandom(e,t){return Math.round(e+Math.random()*t)}static getRandomColor(){const e=["#e53935","#8e24aa","#3949ab","#039be5","#43a047","#c0ca33","#ffb300","#f4511e","#546e7a","#9CCC65","#1565C0","#F06292","#B388FF","#82B1FF","#FF6D00"];return e[n.getRandom(0,e.length-1)]}static templateToFigure(e,t){return t.map((t=>t.map((t=>0!==t?new r.FigurePart(e):t))))}static turnFigure(e){const t=[...e];let i=new Array(t[0].length).fill(0).map((e=>new Array(t.length).fill(0)));return t.forEach(((e,t)=>{e.forEach(((e,r)=>{i[r][i[0].length-t-1]=e}))})),i}static turnFigureBackward(e){const t=[...e];let i=new Array(t[0].length).fill(0).map((e=>new Array(t.length).fill(0)));return t.forEach(((e,t)=>{e.forEach(((e,r)=>{i[i.length-r-1][t]=e}))})),i}}t.Utils=n},892:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=i(220),n=i(496);t.default=class{constructor(e,t){this.template=r.Utils.templateToFigure(e,t),this.x=n.Config.width/n.Config.partSize/2-Math.round(t[0].length/2),this.y=0}render(e){this.template.forEach(((t,i)=>{t.map(((t,r)=>{"number"!=typeof t&&t.render(r+this.x,i+this.y,e)}))}))}turn(){this.template=r.Utils.turnFigure(this.template)}turnBackward(){this.template=r.Utils.turnFigureBackward(this.template)}moveDown(){this.y++}moveLeft(){this.x--}moveRight(){this.x++}getX(){return this.x}getY(){return this.y}setX(e){this.x=e}setY(e){this.y=e}getTemplate(){return this.template}}},996:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=i(496);t.default=class{constructor(e){this.color=e}render(e,t,i){const n=e*r.Config.partSize,s=n+r.Config.partSize,o=t*r.Config.partSize,l=o+r.Config.partSize,a=1.75;i.fillStyle=this.color,i.fillRect(e*r.Config.partSize,t*r.Config.partSize,r.Config.partSize,r.Config.partSize),i.beginPath(),i.lineWidth=3.5,i.strokeStyle="#00000022",this.drawLine(s-a,o,s-a,l,i),this.drawLine(n,l-a,s,l-a,i),i.stroke(),i.beginPath(),i.lineWidth=3.5,i.strokeStyle="#ffffffbb",this.drawLine(n,o+a,s,o+a,i),this.drawLine(n+a,o,n+a,l,i),i.stroke()}drawLine(e,t,i,r,n){n.moveTo(e,t),n.lineTo(i,r)}}},366:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=[[[1,1,1,1]],[[0,1],[0,1],[1,1]],[[1,0],[1,0],[1,1]],[[1,1],[1,1]],[[1,0],[1,1],[0,1]],[[1,0],[1,1],[1,0]],[[0,1],[1,1],[1,0]]]},831:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FigureType=t.FigurePart=t.Figure=void 0;var n=i(892);Object.defineProperty(t,"Figure",{enumerable:!0,get:function(){return r(n).default}});var s=i(996);Object.defineProperty(t,"FigurePart",{enumerable:!0,get:function(){return r(s).default}});var o=i(366);Object.defineProperty(t,"FigureType",{enumerable:!0,get:function(){return r(o).default}})},989:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(i(611));t.default=n.default},994:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(i(987)),s=r(i(284)),o=i(491),l=i(496),a=i(601),h=i(220);class f extends n.default{constructor(e){super(e),this.index=0,this.menu=["Start","Options","About","Github"],this.fieldTemplate=[[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,1,1],[1,1,1,0,0,0,0,1,1,1],[1,1,1,1,0,0,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1]],this.field=new o.Field(this.fieldTemplate),this.color=h.Utils.getRandomColor()}render(e){const t=5*l.Config.height/100;e.fillStyle=this.color,e.fillRect(0,0,l.Config.width,l.Config.height),this.field.render(e),e.fillStyle="#fff",e.font=`${t}px sans-serif`,e.textBaseline="top",e.textAlign="center",this.menu.forEach(((i,r)=>{r!==this.index&&e.fillText(i,l.Config.width/2,l.Config.height/2-this.menu.length/2*t+r*t)})),e.fillStyle="#34495E",e.fillText(this.menu[this.index],l.Config.width/2,l.Config.height/2-this.menu.length/2*t+this.index*t)}select(){switch(this.menu[this.index]){case"Start":const e=new s.default(this.game);e.start(),this.game.setScreen(e);break;case"Options":console.log("OPTIONS");break;case"About":console.log("ABOUT");break;case"Github":window.open("https://github.com/scrolis/tetris-game","_blank")}}keyPressed(e){switch(e.key){case a.KeyType.UP:this.index--,this.index<0&&(this.index=this.menu.length-1);break;case a.KeyType.DOWN:this.index++,this.index>this.menu.length-1&&(this.index=0);break;case a.KeyType.ENTER:this.select()}}}t.default=f},987:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.game=e}}},284:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(i(987)),s=i(220),o=i(491),l=i(831),a=i(496),h=i(601);class f extends n.default{constructor(e){super(e),this.field=new o.Field,this.figure=new l.Figure(s.Utils.getRandomColor(),s.Utils.getRandomFigure())}render(e){e.fillStyle="#ffafaf",e.fillRect(0,0,a.Config.width,a.Config.height),this.field.render(e),this.figure.render(e),this.renderGrid(e)}renderGrid(e){e.strokeStyle="#000000",e.lineWidth=.5;for(let t=0;t<=a.Config.width/a.Config.partSize;t++)e.beginPath(),e.moveTo(t*a.Config.partSize,0),e.lineTo(t*a.Config.partSize,a.Config.height),e.stroke();for(let t=0;t<=a.Config.height/a.Config.partSize;t++)e.beginPath(),e.moveTo(0,t*a.Config.partSize),e.lineTo(a.Config.width,t*a.Config.partSize),e.stroke()}keyPressed(e){switch(e.key){case h.KeyType.LEFT:this.figure.moveLeft(),(this.figure.getX()<0||this.field.checkFieldPartCollision(this.figure))&&this.figure.setX(this.figure.getX()+1);break;case h.KeyType.RIGHT:this.figure.moveRight(),(this.figure.getX()+this.figure.getTemplate()[0].length-1>this.field.getField()[0].length-1||this.field.checkFieldPartCollision(this.figure))&&this.figure.setX(this.figure.getX()-1);break;case h.KeyType.UP:this.turnFigure();break;case h.KeyType.DOWN:this.moveDown()}}moveDown(){this.figure.moveDown(),this.field.checkFieldBottomCollision(this.figure)&&(this.figure.setY(this.figure.getY()-1),this.field.append(this.figure),this.field.checkLinesFilled(this.figure),this.figure=new l.Figure(s.Utils.getRandomColor(),s.Utils.getRandomFigure()),this.field.checkFieldBottomCollision(this.figure)&&this.stop()),this.render(this.game.context)}turnFigure(){this.figure.turn(),this.field.checkFieldPartCollision(this.figure)&&this.figure.turnBackward()}gamePlay(){this.moveDown()}stop(){console.log("STOP"),clearInterval(this.gameTimer)}start(){this.gameTimer=setInterval(this.gamePlay.bind(this),1e3)}}t.default=f},695:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TetrisScreen=t.MenuScreen=t.Screen=void 0;var n=i(987);Object.defineProperty(t,"Screen",{enumerable:!0,get:function(){return r(n).default}});var s=i(994);Object.defineProperty(t,"MenuScreen",{enumerable:!0,get:function(){return r(s).default}});var o=i(284);Object.defineProperty(t,"TetrisScreen",{enumerable:!0,get:function(){return r(o).default}})},607:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(i(989));i(849),i(985);const s=document.getElementById("canvas");new n.default(s)}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(607)})();